<div class="store-edit-container">
    <div class="store-edit-header">
        <div class="header-content">
            <b>Editar Tienda</b>
            <span class="create-status">Diligencia el formulario para editar la tienda</span>
        </div>
    </div>

    <div class="form-container">
        <div class="form-wrapper">
            <div class="overlay" *ngIf="show">
                <div class="center_spinner">
                    <mat-progress-spinner diameter=70 mode="indeterminate" color="accent">
                    </mat-progress-spinner>
                </div>
            </div>

            <form [formGroup]="storeForm" class="store-edit-form">
                <mat-card class="register-form cardpage">
                    <h3 class="titulo"><span>Información de la tienda</span></h3>

                    <div class="row">
                        <div class="col-sm">
                            <div>
                                <label><b>Nombre de la tienda</b><b class="obligatory"> *</b></label>
                                <input placeholder="Nombre de la tienda" formControlName="name_store"
                                    class="form-control" required maxlength="100">
                                <mat-error
                                    *ngIf="storeForm.get('name_store').hasError('required') && storeForm.get('name_store').touched">
                                    Este campo es obligatorio.
                                </mat-error>
                            </div>
                        </div>

                        <div class="col-sm">
                            <div>
                                <label><b>Dirección</b><b class="obligatory"> *</b></label>
                                <input placeholder="Dirección" formControlName="address" class="form-control" required
                                    maxlength="200">
                                <mat-error
                                    *ngIf="storeForm.get('address').hasError('required') && storeForm.get('address').touched">
                                    Este campo es obligatorio.
                                </mat-error>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm">
                            <div>
                                <label><b>Teléfono</b><b class="obligatory"> *</b></label>
                                <input placeholder="Teléfono" formControlName="telephone" class="form-control" required
                                    maxlength="20">
                                <mat-error
                                    *ngIf="storeForm.get('telephone').hasError('required') && storeForm.get('telephone').touched">
                                    Este campo es obligatorio.
                                </mat-error>
                            </div>
                        </div>

                        <div class="col-sm">
                            <div>
                                <label><b>Email</b><b class="obligatory"> *</b></label>
                                <input placeholder="Email" formControlName="email" class="form-control" required
                                    type="email" maxlength="100">
                                <mat-error
                                    *ngIf="storeForm.get('email').hasError('required') && storeForm.get('email').touched">
                                    Este campo es obligatorio.
                                </mat-error>
                                <mat-error
                                    *ngIf="storeForm.get('email').hasError('pattern') && storeForm.get('email').touched">
                                    Email inválido.
                                </mat-error>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm">
                            <div>
                                <label><b>NIT</b><b class="obligatory"> *</b></label>
                                <input placeholder="Número de identificación" formControlName="number_identifier"
                                    class="form-control" required maxlength="50">
                                <mat-error
                                    *ngIf="storeForm.get('number_identifier').hasError('required') && storeForm.get('number_identifier').touched">
                                    Este campo es obligatorio.
                                </mat-error>
                            </div>
                        </div>

                        <div class="col-sm">
                            <div>
                                <label><b>Encargado</b><b class="obligatory"> *</b></label>
                                <input placeholder="Encargado" formControlName="manager" class="form-control" required
                                    maxlength="100">
                                <mat-error
                                    *ngIf="storeForm.get('manager').hasError('required') && storeForm.get('manager').touched">
                                    Este campo es obligatorio.
                                </mat-error>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm">
                            <div>
                                <label><b>Departamento</b><b class="obligatory"> *</b></label>
                                <mat-select formControlName="departmentControl" [(ngModel)]="selectedValue"
                                    (selectionChange)="citieChangeAction($event)" placeholder="Seleccionar departamento"
                                    required>
                                    <mat-option *ngFor="let department of departments" [value]="department">
                                        {{ department.departament }}
                                    </mat-option>
                                </mat-select>
                                <mat-error
                                    *ngIf="storeForm.get('departmentControl').hasError('required') && storeForm.get('departmentControl').touched">
                                    Este campo es obligatorio.
                                </mat-error>
                            </div>
                        </div>

                        <div class="col-sm">
                            <div>
                                <label><b>Ciudad</b><b class="obligatory"> *</b></label>
                                <mat-select formControlName="cityControl" [(ngModel)]="selectedCityValue"
                                    placeholder="Seleccionar ciudad" required>
                                    <mat-option *ngFor="let city of cities" [value]="city">
                                        {{ city.city }}
                                    </mat-option>
                                </mat-select>
                                <mat-error
                                    *ngIf="storeForm.get('cityControl').hasError('required') && storeForm.get('cityControl').touched">
                                    Este campo es obligatorio.
                                </mat-error>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm">
                            <div>
                                <label><b>Categoría</b><b class="obligatory"> *</b></label>
                                <mat-select formControlName="categorystoreCtrl" [(ngModel)]="selectedCategoryValue"
                                    placeholder="Seleccionar categoría" required>
                                    <mat-option *ngFor="let category of storecategory" [value]="category">
                                        {{ category.name_category }}
                                    </mat-option>
                                </mat-select>
                                <mat-error
                                    *ngIf="storeForm.get('categorystoreCtrl').hasError('required') && storeForm.get('categorystoreCtrl').touched">
                                    Este campo es obligatorio.
                                </mat-error>
                            </div>
                        </div>

                        <div class="col-sm">
                            <div>
                                <label><b>Descripción</b><b class="obligatory"> *</b></label>
                                <textarea placeholder="Descripción de la tienda" formControlName="description"
                                    class="form-control" required maxlength="500" rows="3"></textarea>
                                <mat-error
                                    *ngIf="storeForm.get('description').hasError('required') && storeForm.get('description').touched">
                                    Este campo es obligatorio.
                                </mat-error>
                            </div>
                        </div>
                    </div>
                </mat-card>

                <mat-card class="register-form cardpage">
                    <h3 class="titulo"><span>Logo de la tienda</span></h3>
                    <div class="row">
                        <div class="col-sm">
                            <div class="relative img_up mt-3" align="center">
                                <div *ngIf="logo_store" class="current-logo mb-3">
                                    <p><b>Logo actual:</b></p>
                                    <img [src]="logo_store" alt="Logo actual"
                                        style="max-width: 200px; max-height: 200px; border-radius: 8px;">
                                </div>

                                <ngx-dropzone (change)="selectFile($event)" [multiple]="false" [expandable]="true"
                                    [disableClick]="false" [accept]="'image/*'" [maxFileSize]="1000000"
                                    class="dropzone-custom">
                                    <ngx-dropzone-label>
                                        <i class="material-icons">cloud_upload</i>
                                        <p>Arrastra el logo de la tienda aquí!</p>
                                        <small>Formatos: JPG, PNG | Máximo: 1MB | Mínimo: 700x700px</small>
                                    </ngx-dropzone-label>
                                    <ngx-dropzone-image-preview ngProjectAs="ngx-dropzone-preview"
                                        *ngFor="let f of files" [file]="f" [removable]="true" (removed)="onRemove(f)">
                                        <ngx-dropzone-label>{{ f.name }} ({{ f.type }})</ngx-dropzone-label>
                                    </ngx-dropzone-image-preview>
                                </ngx-dropzone>
                            </div>
                        </div>
                    </div>
                </mat-card>

                <mat-card class="register-form cardpage">
                    <div class="form-actions">
                        <button class="color_button_ac mobile-register-btn" mat-raised-button
                            (click)="submitStoreInfo()">
                            Actualizar Tienda
                        </button>
                    </div>
                </mat-card>
            </form>
        </div>
    </div>
</div>