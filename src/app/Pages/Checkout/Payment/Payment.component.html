<div class="checkout-page"
    *ngIf="(embryoService.localStorageCartProducts && embryoService.localStorageCartProducts.length>0); else elseBlock">
    <div class="container">
        <!-- Header -->
        <br>
        <div class="checkout-header">
            <h1 class="checkout-title">Finalizar Compra</h1>
            <div class="checkout-subtitle">Completa tu pedido de forma segura</div>
        </div>

        <div class="checkout-content">
            <!-- Resumen del Pedido -->
            <div class="order-summary">
                <div class="summary-header">
                    <h3>Resumen del Pedido</h3>
                    <button class="view-details-btn" (click)="toggleRightSidenav()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path
                                d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" />
                        </svg>
                        Ver detalles
                    </button>
                </div>

                <div class="summary-total">
                    <div class="total-row">
                        <span class="total-label">Total a pagar</span>
                        <span class="total-amount">{{getCartProducts() | currency : 'USD' : 'symbol' : '1.0-0'}}</span>
                    </div>
                </div>
            </div>

            <!-- Información de Entrega -->
            <div class="delivery-info">
                <div class="delivery-header">
                    <div class="delivery-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path
                                d="M20 8h-3V4H3c-1.1 0-2 .9-2 2v11h2c0 1.66 1.34 3 3 3s3-1.34 3-3h6c0 1.66 1.34 3 3 3s3-1.34 3-3h2v-5l-3-4zM6 18.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm13.5-9l1.96 2.5H17V9.5h2.5zm-1.5 9c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z" />
                        </svg>
                    </div>
                    <div class="delivery-content">
                        <h3>Dirección de entrega</h3>
                        <div class="delivery-address" *ngFor="let location of locationsGrid; last as last">
                            <div class="address-details">
                                <p class="city">{{location.nameci}} - {{location.departament}}</p>
                                <p class="street">{{location.via}} #{{location.number}} - {{location.sn}},
                                    {{location.neighborhood}}</p>
                                <p class="additional" *ngIf="location.additional_data">{{location.additional_data}}</p>
                                <p class="contact">{{location.contact}} - {{location.phone}}</p>
                            </div>
                            <mat-divider *ngIf="!last"></mat-divider>
                        </div>
                    </div>
                </div>

                <button class="change-address-btn" (click)="stablish_predermined(id_com)">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" />
                    </svg>
                    Cambiar dirección
                </button>
            </div>

            <!-- Botón de Pago -->
            <div class="payment-section">
                <button class="pay-button" (click)="finalStep()">
                    <div class="pay-button-content">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path
                                d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z" />
                        </svg>
                        <span>Pagar {{getCartProducts() | currency : 'USD' : 'symbol' : '1.0-0'}}</span>
                    </div>
                    <div class="pay-button-security">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                            <path
                                d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9L10,17Z" />
                        </svg>
                        <span>Pago seguro</span>
                    </div>
                </button>
            </div>
        </div>
    </div>
</div>

<ng-template #elseBlock>
    <div class="empty-checkout-state">
        <div class="empty-checkout-content">
            <div class="empty-checkout-icon">
                <svg width="120" height="120" viewBox="0 0 24 24" fill="none">
                    <path
                        d="M7 18c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12L8.1 13h7.45c.75 0 1.41-.41 1.75-1.03L21.7 4H5.21l-.94-2H1zm16 16c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"
                        fill="#34d399" />
                </svg>
            </div>
            <h2 class="empty-checkout-title">Tu carrito está vacío</h2>
            <p class="empty-checkout-description">Agrega algunos productos increíbles y vuelve aquí para finalizar tu
                compra</p>
            <button class="continue-shopping-btn" [routerLink]="['/']">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z" />
                </svg>
                <span>Continuar Comprando</span>
            </button>
        </div>
    </div>
</ng-template>