<div class="forgot-password-container">
    <div class="overlay" *ngIf="show_spinner">
        <div class="center_spinner">
            <mat-progress-spinner diameter=70 mode="indeterminate" color="accent">
            </mat-progress-spinner>
        </div>
    </div>
    
    <div class="forgot-password-content">
        <div class="forgot-password-header">
            <h1 class="forgot-password-title">¿Olvidaste tu contraseña?</h1>
            <p class="forgot-password-subtitle">Indícanos tu correo electrónico, te enviaremos un mensaje de reestablecimiento</p>
        </div>
        
        <div class="forgot-password-form-container" *ngIf="form_restore_view">
            <form [formGroup]="forgotForm" class="forgot-password-form">
                <!-- Email Field -->
                <div class="form-field-group">
                    <label class="form-label">E-MAIL</label>
                    <div class="input-container">
                        <mat-icon class="input-icon">email</mat-icon>
                        <input type="email" 
                               formControlName="email" 
                               placeholder="e-mail registrado" 
                               class="form-input"
                               maxlength="50"
                               required>
                    </div>
                    <div *ngIf="forgotForm.controls['email'].touched && !forgotForm.controls['email'].valid" class="error-message">
                        <div *ngIf="forgotForm.controls['email'].hasError('required')">
                            Debes ingresar un email
                        </div>
                        <div *ngIf="forgotForm.controls['email'].hasError('pattern')">
                            Debes incluir un formato de email válido
                        </div>
                    </div>
                </div>

                <!-- Repeat Email Field -->
                <div class="form-field-group">
                    <label class="form-label">REPETIR E-MAIL</label>
                    <div class="input-container">
                        <mat-icon class="input-icon">email</mat-icon>
                        <input type="email" 
                               formControlName="reply_email" 
                               placeholder="repetir e-mail" 
                               class="form-input"
                               maxlength="50"
                               required>
                    </div>
                    <div *ngIf="forgotForm.controls['reply_email'].touched && !forgotForm.controls['reply_email'].valid" class="error-message">
                        <div *ngIf="forgotForm.controls['reply_email'].hasError('required')">
                            Debes repetir el email
                        </div>
                        <div *ngIf="forgotForm.controls['reply_email'].hasError('pattern')">
                            Debes incluir un formato de email válido
                        </div>
                    </div>
                </div>

                <!-- Error Messages -->
                <div class="error-message-global" *ngIf="validate_same_email">
                    <mat-icon class="error-icon">error</mat-icon>
                    <span>Los emails no son iguales</span>
                </div>
                
                <div class="error-message-global" *ngIf="validate_user">
                    <mat-icon class="error-icon">error</mat-icon>
                    <span>Usuario no existe, debes realizar un registro o ingresar un email válido</span>
                </div>

                <!-- Submit Button -->
                <button class="submit-button" 
                        mat-raised-button 
                        (click)="resetEmail()" 
                        [disabled]="btnDisabled || forgotForm.invalid">
                    <span>Enviar</span>
                </button>

                <!-- Back to Login -->
                <div class="back-to-login">
                    <p class="back-text">¿Ya tienes una cuenta?</p>
                    <a [routerLink]="['/session/signin']" class="back-link">
                        Entonces ingresa
                    </a>
                </div>
            </form>
        </div>

        <!-- Success Message -->
        <div class="success-message" *ngIf="response_send_restore_view">
            <mat-icon class="success-icon">check_circle</mat-icon>
            <h3>¡Correo enviado!</h3>
            <p>Se envió un correo de reestablecimiento a tu email</p>
        </div>
    </div>
</div>